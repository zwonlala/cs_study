211005 5주차 2강 임계구역 문제 1회독함 -> 정리하기!

BankAccount Problem

- 해결하기 위해서는 

atomic : 원자
한 덩어리로 일어나고 중간에 콘텍스트 스위칭이 일어나면 안됨

임계구역 문제

The Critical-Section Problem

임계구역 : 여러개의 쓰레드로 이루어진 프로그램에서, 코드 영역을 크리티컬 섹션이라고 한다

함께사용하는 변수,테이블,파일(Common)을 수정하는

걸 Critical-Section 문제라고 한다


ex) Parent, Child 예제

- Parent : 반복문을 돌면서 balance = balance + 1;

- Child : 반복문을 돌면서 balance = balance - 1;


복수개의 쓰레드가 있는데
콤몬으로 사용하는 공통으로 사용하는 변수, 테이블, 파일이라고 함

## solution

1. Mutual exclusive(상포 배타): 오류가 일어나지 않으려면, 상호 배타적이어야 한다. 오직 한개의 쓰레드만 진입
2. Progress(진입) : 진입 순서 결정은 유한 시간 내에 결정되어야 한다
3. Bounded Waiting(유한 대기) : 어느 쓰레드라도 유한 시간 내 크리티컬 섹션 내에 들어갈 수있어야 한다

위 3가지 조건을 모두 만족해야 만 크리티컬 섹션 문제를 해결할 수 있음


프로세스/쓰레드 동기화

- 임계구역 문제 해결 (틀린 답이 나오지 않도록)
- 프로세스 실행 순서 제어(원하는 대로)
- Busy Wait 등 비효율성을 제거

OS에서 해야할 일은 
1. Process mangent -> 제일 중요
	- CPU 스케쥴링
	- Synchronization(동기화) 
		- -> **임계구역 문제를 해결**
		- ->우리가 원하는 대로 프로세스 순서를 정할 수 있어야 함....
2. Main Mem mangement
...



어떻게 하면 프로세스 동기화를 잘할 수 있을 것인가?

대표적인게 세마포, 모니터





### 세마포 

가장 전통적인 동기화 도구
> 사전 ver.> 철도의 신호기, 군대의 수신호   

> os ver.> 동기화 문제 해결을 위한 소프트웨어 툴   

네덜란드 사람 딕스터?라 만들어냄

내부구조는 정수형 변수 하나와 두개의 함수로 이루어져 있음

int 변수 하나와
두개의 동작
- p 동작: Proberen(test) : 검사한다 acquire
- v 동작: Vethogen(increment) : release

스택 
배열
푸쉬 
팝


세마포
정수값
p 동작
v 동작


acquire를 호출하게 되면
-> 졍수값이 1만큼 작아짐
-> 감소된 값이 0보다 작아지면, 호출한 프로세스를 큐에 넣어준다
(다른 프로세스가 꺼내줄 때까진 아무것도 못함)

큐 (리스트)에 콜한 프로세스를 넣어준다(블락)

release를 호출하게 되면,
정수값을 1만큼 증가시키고

해당 정수값이 0이거나 음수이면, 큐에서 하나 빼와서 해방시켜 준다




컴퓨터 시스템에는 큐가 많음.

io를 만나면, io 서비스를 받아야 하는데,
다른 프로세서가 이미 io를 쓰고 있다면 대기
=> io 큐, 디바이스 큐







타임 쉐어링 쓰템





세마포 안에 보면, 정수값도 있지만 큐(줄)도 있다


wake up : 큐에 있던 한 프로세스를 꺼내어 다시 레디큐로 보내줘~


밸류는 뭘 의미하는가?
//number of permits //허용되는 권한의 개수


세마포는 일반적으로 어떤 목적으로 사용하는가?
동기화 중에서도 mutual exclusive(상호 배타) 목적으로 사용된다!

한 프로세스가 critical section에 들어오면, 다른 프로세스가 못들어온다(== mutual exclusive)





